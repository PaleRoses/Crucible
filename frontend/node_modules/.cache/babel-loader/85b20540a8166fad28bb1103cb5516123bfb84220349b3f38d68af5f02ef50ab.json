{"ast":null,"code":"var _jsxFileName = \"/home/valeria/Documents/Crucible/frontend/src/components/core/Background.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport { createUseStyles } from 'react-jss';\n\n// Enhanced CSS-in-JS styles with hardware acceleration and performance optimizations\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = createUseStyles({\n  backgroundWrapper: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    zIndex: 1,\n    pointerEvents: 'none',\n    overflow: 'hidden',\n    // Hardware acceleration\n    transform: 'translateZ(0)',\n    backfaceVisibility: 'hidden',\n    perspective: 1000,\n    willChange: 'transform'\n  },\n  backgroundBlack: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    backgroundColor: '#000000',\n    zIndex: 1\n  },\n  backgroundCanvas: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    zIndex: 1,\n    pointerEvents: 'none',\n    // Hardware acceleration\n    transform: 'translateZ(0)',\n    backfaceVisibility: 'hidden',\n    perspective: 1000,\n    willChange: 'transform',\n    // Ensure proper rendering\n    imageRendering: 'high-quality'\n  }\n});\n\n// Enhanced constellation definitions with more stars and connections\nconst CONSTELLATIONS = [{\n  name: 'Ursa Major',\n  vertices: [{\n    x: 0.2,\n    y: 0.3\n  }, {\n    x: 0.25,\n    y: 0.28\n  }, {\n    x: 0.3,\n    y: 0.25\n  }, {\n    x: 0.35,\n    y: 0.23\n  }, {\n    x: 0.37,\n    y: 0.18\n  }, {\n    x: 0.33,\n    y: 0.15\n  }, {\n    x: 0.28,\n    y: 0.15\n  }],\n  edges: [[0, 1], [1, 2], [2, 3], [3, 4], [4, 5], [5, 6]]\n}, {\n  name: 'Cassiopeia',\n  vertices: [{\n    x: 0.7,\n    y: 0.15\n  }, {\n    x: 0.75,\n    y: 0.2\n  }, {\n    x: 0.8,\n    y: 0.15\n  }, {\n    x: 0.85,\n    y: 0.2\n  }, {\n    x: 0.9,\n    y: 0.15\n  }],\n  edges: [[0, 1], [1, 2], [2, 3], [3, 4]]\n}, {\n  name: 'Orion',\n  vertices: [{\n    x: 0.5,\n    y: 0.5\n  }, {\n    x: 0.48,\n    y: 0.45\n  }, {\n    x: 0.52,\n    y: 0.45\n  }, {\n    x: 0.51,\n    y: 0.4\n  }, {\n    x: 0.5,\n    y: 0.35\n  }, {\n    x: 0.53,\n    y: 0.32\n  }, {\n    x: 0.47,\n    y: 0.32\n  }],\n  edges: [[0, 1], [0, 2], [1, 3], [2, 3], [3, 4], [4, 5], [4, 6]]\n}, {\n  name: 'Cygnus',\n  vertices: [{\n    x: 0.15,\n    y: 0.65\n  }, {\n    x: 0.2,\n    y: 0.6\n  }, {\n    x: 0.25,\n    y: 0.55\n  }, {\n    x: 0.3,\n    y: 0.5\n  }, {\n    x: 0.35,\n    y: 0.45\n  }, {\n    x: 0.25,\n    y: 0.5\n  }, {\n    x: 0.15,\n    y: 0.5\n  }],\n  edges: [[0, 1], [1, 2], [2, 3], [3, 4], [2, 5], [5, 6]]\n}];\n\n/**\n * Enterprise-grade Background Component\n * \n * Creates a high-performance animated starry background with constellations,\n * interactive cursor effects, and optimized rendering for all devices.\n * \n * Features:\n * - Hardware accelerated rendering with Canvas 2D or WebGL\n * - Device-adaptive quality settings for better performance\n * - Optimized memory usage with object pooling\n * - Battery-aware rendering for mobile devices\n * - Smooth animations with efficient frame management\n * - Enhanced visual effects with adaptive detail levels\n * \n * @param {Object} props - Component props\n * @param {Object} props.cursorPosition - Current cursor coordinates\n * @param {Function} props.setCursorPosition - Function to update cursor position\n * @param {boolean} [props.enableWebGL=false] - Enable WebGL rendering for better performance\n * @param {boolean} [props.adaptiveQuality=true] - Enable adaptive quality based on device\n * @param {boolean} [props.enableParallax=true] - Enable parallax effect on scroll/cursor\n * @param {boolean} [props.respectReducedMotion=true] - Respect reduced motion preferences\n * @param {number} [props.particleCount=80] - Number of background particles\n * @param {boolean} [props.enableCursorGlow=true] - Enable cursor glow effect\n * @param {number} [props.targetFPS=30] - Target frame rate\n * @param {boolean} [props.enableStarBurst=true] - Enable occasional star burst effects\n */\nconst Background = ({\n  cursorPosition,\n  setCursorPosition,\n  enableWebGL = false,\n  adaptiveQuality = true,\n  enableParallax = true,\n  respectReducedMotion = true,\n  particleCount = 80,\n  enableCursorGlow = true,\n  targetFPS = 30,\n  enableStarBurst = true\n}) => {\n  _s();\n  // Styles and refs\n  const classes = useStyles();\n  const canvasRef = useRef(null);\n  const particlesRef = useRef([]);\n  const constellationsRef = useRef([]);\n  const requestRef = useRef(null);\n  const timeRef = useRef(0);\n  const lastFrameTimeRef = useRef(0);\n  const frameCountRef = useRef(0);\n  const fpsCounterRef = useRef(0);\n  const lastRenderTimeRef = useRef(0);\n  const webGLRef = useRef(null);\n\n  // Component state\n  const [dimensions, setDimensions] = useState({\n    width: 0,\n    height: 0,\n    pixelRatio: 1\n  });\n  const [isVisible, setIsVisible] = useState(true);\n  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);\n  const [qualityFactor, setQualityFactor] = useState(1);\n  const [renderingMode, setRenderingMode] = useState('2d');\n  const [deviceCapabilities, setDeviceCapabilities] = useState({\n    isMobile: false,\n    batteryLevel: 1,\n    isCharging: true,\n    memoryLimit: false\n  });\n\n  // Optimized cursor position with interpolation for smoother movement\n  const smoothCursorPosition = useRef({\n    x: 0,\n    y: 0\n  });\n\n  // Particle and star burst object pools\n  const particlePoolRef = useRef([]);\n  const starBurstPoolRef = useRef([]);\n  const activeStarBurstsRef = useRef([]);\n\n  // Color caching to avoid string operations during rendering\n  const colorCacheRef = useRef(new Map());\n\n  // Get cached color with opacity\n  const getCachedColor = useCallback((baseColor, opacity) => {\n    // Round opacity to reduce cache size (0.01 precision is enough for visual effects)\n    const roundedOpacity = Math.round(opacity * 100) / 100;\n    const key = `${baseColor}-${roundedOpacity}`;\n    if (!colorCacheRef.current.has(key)) {\n      const newColor = baseColor.replace(/[\\d.]+\\)$/, roundedOpacity + ')');\n      colorCacheRef.current.set(key, newColor);\n    }\n    return colorCacheRef.current.get(key);\n  }, []);\n\n  // Detect device capabilities and set appropriate quality levels\n  const detectCapabilities = useCallback(() => {\n    // Check for mobile devices\n    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n\n    // Check for WebGL support\n    let webGLSupported = false;\n    if (enableWebGL) {\n      try {\n        const canvas = document.createElement('canvas');\n        webGLSupported = !!(window.WebGLRenderingContext && (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));\n      } catch (e) {\n        webGLSupported = false;\n      }\n    }\n\n    // Set rendering mode based on capabilities\n    setRenderingMode(webGLSupported && enableWebGL ? 'webgl' : '2d');\n\n    // Set device capability state\n    setDeviceCapabilities(prev => ({\n      ...prev,\n      isMobile\n    }));\n\n    // Determine quality factor based on device capabilities\n    if (adaptiveQuality) {\n      const memory = navigator.deviceMemory || 4; // Default to 4GB if not available\n      const cores = navigator.hardwareConcurrency || 4; // Default to 4 cores\n\n      // Calculate performance score\n      const performanceScore = memory * cores / (isMobile ? 2 : 1);\n\n      // Scale quality based on performance score\n      let quality = 1;\n      if (performanceScore > 16) {\n        quality = 1; // High-end devices\n      } else if (performanceScore > 8) {\n        quality = 0.85; // Mid-range devices\n      } else if (performanceScore > 4) {\n        quality = 0.7; // Low-end devices\n      } else {\n        quality = 0.5; // Very low-end devices\n      }\n      setQualityFactor(quality);\n    }\n\n    // Check battery status if available\n    if (navigator.getBattery) {\n      navigator.getBattery().then(battery => {\n        const updateBattery = () => {\n          setDeviceCapabilities(prev => ({\n            ...prev,\n            batteryLevel: battery.level,\n            isCharging: battery.charging\n          }));\n\n          // Reduce quality if on low battery and not charging\n          if (!battery.charging && battery.level < 0.3 && adaptiveQuality) {\n            setQualityFactor(prev => Math.min(prev, 0.6));\n          }\n        };\n\n        // Add battery event listeners\n        battery.addEventListener('levelchange', updateBattery);\n        battery.addEventListener('chargingchange', updateBattery);\n\n        // Initial update\n        updateBattery();\n      });\n    }\n  }, [enableWebGL, adaptiveQuality]);\n\n  // Calculate adaptive settings based on device capabilities and quality factor\n  const adaptiveSettings = useMemo(() => {\n    const actualParticleCount = Math.max(40, Math.floor(particleCount * qualityFactor));\n    return {\n      particleCount: actualParticleCount,\n      starSize: qualityFactor > 0.8 ? 1 : 0.8,\n      useGlow: qualityFactor > 0.6,\n      useHighQualityEdges: qualityFactor > 0.7,\n      constellationOpacity: 0.1 * qualityFactor,\n      twinkleFrequency: qualityFactor > 0.7 ? 0.0004 : 0.0002,\n      particleSpeed: 0.15 * qualityFactor\n    };\n  }, [qualityFactor, particleCount]);\n\n  // Initialize particles with appropriate pooling\n  const initializeParticles = useCallback(() => {\n    if (!dimensions.width || !dimensions.height) return;\n    const width = dimensions.width;\n    const height = dimensions.height;\n\n    // Create new particles\n    const newParticles = [];\n\n    // Try to get from pool first, then create new ones if needed\n    for (let i = 0; i < adaptiveSettings.particleCount; i++) {\n      let particle;\n      if (particlePoolRef.current.length > 0) {\n        // Reuse from pool\n        particle = particlePoolRef.current.pop();\n\n        // Reset particle properties\n        particle.x = Math.random() * width;\n        particle.y = Math.random() * height;\n        particle.isTwinkling = false;\n      } else {\n        // Create new particle\n        particle = {\n          x: Math.random() * width,\n          y: Math.random() * height,\n          size: Math.random() * 1.5 * adaptiveSettings.starSize + 0.5,\n          baseSize: Math.random() * 1.5 * adaptiveSettings.starSize + 0.5,\n          speedX: (Math.random() - 0.5) * adaptiveSettings.particleSpeed,\n          speedY: (Math.random() - 0.5) * adaptiveSettings.particleSpeed,\n          opacity: Math.random() * 0.3 + 0.05,\n          baseOpacity: Math.random() * 0.3 + 0.05,\n          twinkleSpeed: Math.random() * 0.02 + 0.005,\n          twinklePhase: Math.random() * Math.PI * 2,\n          twinkleProbability: Math.random() * adaptiveSettings.twinkleFrequency + 0.0001,\n          isTwinkling: false,\n          // For star bursts\n          canBurst: Math.random() < 0.1,\n          // 10% of stars can burst\n          burstThreshold: Math.random() * 0.002 + 0.0001,\n          lastBurstTime: 0,\n          burstCooldown: Math.random() * 15000 + 5000\n        };\n      }\n      newParticles.push(particle);\n    }\n    particlesRef.current = newParticles;\n  }, [dimensions, adaptiveSettings]);\n\n  // Initialize constellations\n  const initializeConstellations = useCallback(() => {\n    if (!dimensions.width || !dimensions.height) return;\n\n    // Initialize constellations with actual screen positions\n    constellationsRef.current = CONSTELLATIONS.map(constellation => {\n      const vertices = constellation.vertices.map(vertex => ({\n        x: vertex.x * dimensions.width,\n        y: vertex.y * dimensions.height,\n        size: 1.8 * adaptiveSettings.starSize,\n        baseSize: 1.8 * adaptiveSettings.starSize,\n        opacity: 0.25 * qualityFactor,\n        baseOpacity: 0.25 * qualityFactor,\n        isTwinkling: false,\n        twinkleProgress: 0,\n        twinkleSpeed: Math.random() * 0.03 + 0.01,\n        lastTwinkle: 0,\n        twinkleInterval: Math.random() * 5000 + 2000,\n        // For parallax effect\n        originalX: vertex.x * dimensions.width,\n        originalY: vertex.y * dimensions.height,\n        parallaxFactor: Math.random() * 0.2 + 0.1\n      }));\n      return {\n        name: constellation.name,\n        vertices,\n        edges: constellation.edges,\n        // For occasional constellation highlighting\n        isHighlighted: false,\n        highlightProgress: 0,\n        highlightSpeed: 0.01,\n        lastHighlight: 0,\n        highlightInterval: Math.random() * 30000 + 20000\n      };\n    });\n  }, [dimensions, adaptiveSettings.starSize, qualityFactor]);\n\n  // Create star burst effect at a specific position\n  const createStarBurst = useCallback((x, y, size = 2, particleCount = 8) => {\n    if (!enableStarBurst) return;\n    for (let i = 0; i < particleCount; i++) {\n      // Try to get from pool first\n      let burst;\n      if (starBurstPoolRef.current.length > 0) {\n        burst = starBurstPoolRef.current.pop();\n\n        // Reset burst properties\n        burst.life = 1.0;\n        burst.x = x;\n        burst.y = y;\n      } else {\n        // Create new burst particle\n        burst = {\n          x,\n          y,\n          vx: 0,\n          vy: 0,\n          size: 0,\n          life: 1.0,\n          decay: 0\n        };\n      }\n\n      // Randomize burst parameters\n      const angle = Math.random() * Math.PI * 2;\n      const speed = Math.random() * 2 + 0.5;\n      burst.vx = Math.cos(angle) * speed;\n      burst.vy = Math.sin(angle) * speed;\n      burst.size = size * (0.5 + Math.random() * 0.5);\n      burst.decay = 0.01 + Math.random() * 0.02;\n      activeStarBurstsRef.current.push(burst);\n    }\n  }, [enableStarBurst]);\n\n  // Initialize WebGL context if enabled\n  const initWebGL = useCallback(() => {\n    if (!canvasRef.current || renderingMode !== 'webgl') return false;\n    try {\n      const gl = canvasRef.current.getContext('webgl', {\n        alpha: true,\n        antialias: true,\n        premultipliedAlpha: false,\n        depth: false,\n        powerPreference: 'default'\n      });\n      if (!gl) return false;\n      webGLRef.current = gl;\n\n      // Basic WebGL setup (simplified)\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n      gl.clearColor(0.0, 0.0, 0.0, 1.0);\n      return true;\n    } catch (error) {\n      console.error('WebGL initialization error:', error);\n      setRenderingMode('2d');\n      return false;\n    }\n  }, [renderingMode]);\n\n  // Canvas setup with proper scaling for high-DPI displays\n  const setupCanvas = useCallback(() => {\n    if (!canvasRef.current) return false;\n    const canvas = canvasRef.current;\n    const pixelRatio = window.devicePixelRatio || 1;\n\n    // Get display dimensions\n    const displayWidth = window.innerWidth;\n    const displayHeight = window.innerHeight;\n\n    // Set canvas rendering size (accounting for pixel ratio)\n    canvas.width = displayWidth * pixelRatio;\n    canvas.height = displayHeight * pixelRatio;\n\n    // Set display size via CSS\n    canvas.style.width = `${displayWidth}px`;\n    canvas.style.height = `${displayHeight}px`;\n\n    // Store dimensions\n    setDimensions({\n      width: displayWidth,\n      height: displayHeight,\n      pixelRatio\n    });\n\n    // Initialize appropriate rendering context\n    if (renderingMode === 'webgl') {\n      if (!initWebGL()) {\n        // Fallback to 2D if WebGL fails\n        const ctx = canvas.getContext('2d');\n        ctx.scale(pixelRatio, pixelRatio);\n      }\n    } else {\n      // 2D Canvas context\n      const ctx = canvas.getContext('2d', {\n        alpha: true,\n        desynchronized: true,\n        willReadFrequently: false\n      });\n      if (!ctx) return false;\n\n      // Scale context for high-DPI displays\n      ctx.scale(pixelRatio, pixelRatio);\n\n      // Enable high-quality rendering if device can handle it\n      if (qualityFactor > 0.7) {\n        ctx.imageSmoothingEnabled = true;\n        ctx.imageSmoothingQuality = 'high';\n      }\n    }\n    return true;\n  }, [qualityFactor, renderingMode, initWebGL]);\n\n  // Handle window resize\n  const handleResize = useCallback(() => {\n    if (setupCanvas()) {\n      // Reinitialize particles and constellations\n      initializeParticles();\n      initializeConstellations();\n    }\n  }, [setupCanvas, initializeParticles, initializeConstellations]);\n\n  // Detect device capabilities and preferences\n  useEffect(() => {\n    // Check for reduced motion preference\n    const reducedMotionQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\n    setPrefersReducedMotion(reducedMotionQuery.matches);\n    const handleReducedMotionChange = e => {\n      setPrefersReducedMotion(e.matches);\n    };\n    reducedMotionQuery.addEventListener('change', handleReducedMotionChange);\n\n    // Detect device capabilities\n    detectCapabilities();\n\n    // Handle visibility changes\n    const handleVisibilityChange = () => {\n      setIsVisible(!document.hidden);\n    };\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n    return () => {\n      reducedMotionQuery.removeEventListener('change', handleReducedMotionChange);\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n    };\n  }, [detectCapabilities]);\n\n  // Set up responsive canvas and initialize particles\n  useEffect(() => {\n    // Initial setup\n    setupCanvas();\n\n    // Add resize listener\n    window.addEventListener('resize', handleResize);\n    return () => {\n      window.removeEventListener('resize', handleResize);\n      if (requestRef.current) {\n        cancelAnimationFrame(requestRef.current);\n      }\n    };\n  }, [setupCanvas, handleResize]);\n\n  // Initialize particles and constellations when dimensions are available\n  useEffect(() => {\n    if (dimensions.width && dimensions.height) {\n      initializeParticles();\n      initializeConstellations();\n    }\n  }, [dimensions, initializeParticles, initializeConstellations]);\n\n  // Draw 2D canvas background\n  const drawBackground2D = useCallback((ctx, timestamp, deltaTime) => {\n    // Start with black background\n    ctx.fillStyle = '#000000';\n    ctx.fillRect(0, 0, dimensions.width, dimensions.height);\n\n    // Calculate interpolated cursor position for smoother effects\n    if (cursorPosition.x && cursorPosition.y) {\n      smoothCursorPosition.current.x += (cursorPosition.x - smoothCursorPosition.current.x) * 0.1;\n      smoothCursorPosition.current.y += (cursorPosition.y - smoothCursorPosition.current.y) * 0.1;\n    }\n\n    // Calculate parallax offset based on cursor position\n    const parallaxOffsetX = enableParallax ? (smoothCursorPosition.current.x - dimensions.width / 2) / 20 : 0;\n    const parallaxOffsetY = enableParallax ? (smoothCursorPosition.current.y - dimensions.height / 2) / 20 : 0;\n\n    // Draw regular particles\n    particlesRef.current.forEach(particle => {\n      // Skip updates if reduced motion is preferred\n      if (!(respectReducedMotion && prefersReducedMotion)) {\n        // Update position\n        particle.x += particle.speedX;\n        particle.y += particle.speedY;\n\n        // Wrap around screen with buffer\n        if (particle.x < -20) particle.x = dimensions.width + 20;\n        if (particle.x > dimensions.width + 20) particle.x = -20;\n        if (particle.y < -20) particle.y = dimensions.height + 20;\n        if (particle.y > dimensions.height + 20) particle.y = -20;\n      }\n\n      // Handle twinkling effect\n      if (Math.random() < particle.twinkleProbability) {\n        particle.isTwinkling = true;\n      }\n      let particleOpacity = particle.opacity;\n      let particleSize = particle.size;\n      if (particle.isTwinkling) {\n        // Use sine wave for smooth twinkling effect\n        const twinkleFactor = Math.sin(timestamp * 0.001 * particle.twinkleSpeed + particle.twinklePhase);\n        const normalizedTwinkle = (twinkleFactor + 1) / 2; // Convert from [-1,1] to [0,1]\n\n        particleSize = particle.baseSize + particle.baseSize * 0.7 * normalizedTwinkle;\n        particleOpacity = particle.baseOpacity + 0.4 * normalizedTwinkle;\n\n        // Complete one twinkle cycle\n        if (timestamp * 0.001 * particle.twinkleSpeed + particle.twinklePhase > particle.twinklePhase + Math.PI * 2) {\n          particle.isTwinkling = false;\n          particle.twinklePhase = Math.random() * Math.PI * 2; // Reset phase for next time\n        }\n      }\n\n      // Check for star burst\n      if (enableStarBurst && particle.canBurst && Math.random() < particle.burstThreshold && timestamp - particle.lastBurstTime > particle.burstCooldown) {\n        createStarBurst(particle.x, particle.y, particle.size * 1.5, 8);\n        particle.lastBurstTime = timestamp;\n      }\n\n      // Compute final position with parallax\n      const drawX = particle.x + parallaxOffsetX * 0.5;\n      const drawY = particle.y + parallaxOffsetY * 0.5;\n\n      // Draw particle\n      ctx.beginPath();\n      ctx.arc(drawX, drawY, particleSize, 0, Math.PI * 2);\n      ctx.fillStyle = getCachedColor('rgba(191, 173, 127) ', particleOpacity);\n      ctx.fill();\n\n      // Add glow effect for larger or twinkling particles if quality permits\n      if (adaptiveSettings.useGlow && (particleSize > 1.3 || particle.isTwinkling)) {\n        ctx.beginPath();\n        ctx.arc(drawX, drawY, particleSize * 2, 0, Math.PI * 2);\n        const gradient = ctx.createRadialGradient(drawX, drawY, particleSize * 0.5, drawX, drawY, particleSize * 2);\n        gradient.addColorStop(0, getCachedColor('rgba(191, 173, 127)', particleOpacity * 0.4));\n        gradient.addColorStop(1, 'rgba(191, 173, 127, 0)');\n        ctx.fillStyle = gradient;\n        ctx.fill();\n      }\n    });\n\n    // Draw constellations\n    constellationsRef.current.forEach(constellation => {\n      const now = timestamp;\n      let edgeOpacity = adaptiveSettings.constellationOpacity;\n      let vertexMultiplier = 1;\n\n      // Check if it's time to highlight this constellation\n      if (now - constellation.lastHighlight > constellation.highlightInterval) {\n        constellation.isHighlighted = true;\n        constellation.highlightProgress = 0;\n        constellation.lastHighlight = now;\n      }\n\n      // Handle highlighting animation\n      if (constellation.isHighlighted) {\n        constellation.highlightProgress += constellation.highlightSpeed * (deltaTime / 16);\n\n        // Create a pulse effect for highlighting\n        const highlightPulse = Math.sin(constellation.highlightProgress * Math.PI);\n        edgeOpacity += highlightPulse * 0.15;\n        vertexMultiplier += highlightPulse * 0.5;\n\n        // End highlighting after one cycle\n        if (constellation.highlightProgress >= 1) {\n          constellation.isHighlighted = false;\n        }\n      }\n\n      // Draw edges (lines) first so they appear behind vertices\n      if (adaptiveSettings.useHighQualityEdges) {\n        // Enhanced edges with gradient for higher quality settings\n        constellation.edges.forEach(edge => {\n          const startVertex = constellation.vertices[edge[0]];\n          const endVertex = constellation.vertices[edge[1]];\n\n          // Apply parallax to edge vertices\n          const startX = startVertex.x + parallaxOffsetX * startVertex.parallaxFactor;\n          const startY = startVertex.y + parallaxOffsetY * startVertex.parallaxFactor;\n          const endX = endVertex.x + parallaxOffsetX * endVertex.parallaxFactor;\n          const endY = endVertex.y + parallaxOffsetY * endVertex.parallaxFactor;\n\n          // Create gradient along the line\n          const gradient = ctx.createLinearGradient(startX, startY, endX, endY);\n          gradient.addColorStop(0, getCachedColor('rgba(191, 173, 127, ', edgeOpacity));\n          gradient.addColorStop(0.5, getCachedColor('rgba(191, 173, 127, ', edgeOpacity * 1.3));\n          gradient.addColorStop(1, getCachedColor('rgba(191, 173, 127, ', edgeOpacity));\n          ctx.beginPath();\n          ctx.moveTo(startX, startY);\n          ctx.lineTo(endX, endY);\n          ctx.strokeStyle = gradient;\n          ctx.lineWidth = 0.5;\n          ctx.stroke();\n        });\n      } else {\n        // Simple edges for lower quality settings\n        ctx.beginPath();\n        ctx.strokeStyle = getCachedColor('rgba(191, 173, 127, ', edgeOpacity);\n        ctx.lineWidth = 0.5;\n        constellation.edges.forEach(edge => {\n          const startVertex = constellation.vertices[edge[0]];\n          const endVertex = constellation.vertices[edge[1]];\n\n          // Apply parallax\n          const startX = startVertex.x + parallaxOffsetX * startVertex.parallaxFactor;\n          const startY = startVertex.y + parallaxOffsetY * startVertex.parallaxFactor;\n          const endX = endVertex.x + parallaxOffsetX * endVertex.parallaxFactor;\n          const endY = endVertex.y + parallaxOffsetY * endVertex.parallaxFactor;\n          ctx.moveTo(startX, startY);\n          ctx.lineTo(endX, endY);\n        });\n        ctx.stroke();\n      }\n\n      // Draw and update vertices\n      constellation.vertices.forEach(vertex => {\n        // Occasional twinkling for constellation stars\n        if (timestamp - vertex.lastTwinkle > vertex.twinkleInterval) {\n          vertex.isTwinkling = true;\n          vertex.twinkleProgress = 0;\n          vertex.lastTwinkle = timestamp;\n        }\n        let vertexSize = vertex.size * vertexMultiplier;\n        let vertexOpacity = vertex.opacity * vertexMultiplier;\n        if (vertex.isTwinkling) {\n          vertex.twinkleProgress += vertex.twinkleSpeed * (deltaTime / 16);\n\n          // Create a pulse effect\n          const pulseFactor = Math.sin(vertex.twinkleProgress * Math.PI);\n          vertexSize += vertex.baseSize * pulseFactor * 0.5;\n          vertexOpacity += 0.3 * pulseFactor;\n\n          // End twinkling after one cycle\n          if (vertex.twinkleProgress >= 1) {\n            vertex.isTwinkling = false;\n          }\n        }\n\n        // Apply parallax to vertex position\n        const drawX = vertex.x + parallaxOffsetX * vertex.parallaxFactor;\n        const drawY = vertex.y + parallaxOffsetY * vertex.parallaxFactor;\n\n        // Draw constellation vertex\n        ctx.beginPath();\n        ctx.arc(drawX, drawY, vertexSize, 0, Math.PI * 2);\n        ctx.fillStyle = getCachedColor('rgba(207, 185, 130, ', vertexOpacity);\n        ctx.fill();\n\n        // Add glow for constellation vertices if quality permits\n        if (adaptiveSettings.useGlow) {\n          ctx.beginPath();\n          ctx.arc(drawX, drawY, vertexSize * 3, 0, Math.PI * 2);\n          const gradient = ctx.createRadialGradient(drawX, drawY, vertexSize * 0.5, drawX, drawY, vertexSize * 3);\n          gradient.addColorStop(0, getCachedColor('rgba(207, 185, 130, ', vertexOpacity * 0.4));\n          gradient.addColorStop(1, 'rgba(207, 185, 130, 0)');\n          ctx.fillStyle = gradient;\n          ctx.fill();\n        }\n      });\n    });\n\n    // Draw active star bursts\n    activeStarBurstsRef.current.forEach((burst, index) => {\n      // Update burst position and life\n      burst.x += burst.vx;\n      burst.y += burst.vy;\n      burst.life -= burst.decay * (deltaTime / 16);\n\n      // Remove if life is depleted\n      if (burst.life <= 0) {\n        // Return to pool\n        starBurstPoolRef.current.push(burst);\n        activeStarBurstsRef.current.splice(index, 1);\n        return;\n      }\n\n      // Draw burst particle\n      ctx.beginPath();\n      ctx.arc(burst.x, burst.y, burst.size * burst.life, 0, Math.PI * 2);\n      ctx.fillStyle = getCachedColor('rgba(207, 185, 130, ', burst.life * 0.7);\n      ctx.fill();\n\n      // Add glow for bursts\n      if (adaptiveSettings.useGlow) {\n        ctx.beginPath();\n        ctx.arc(burst.x, burst.y, burst.size * burst.life * 2, 0, Math.PI * 2);\n        const gradient = ctx.createRadialGradient(burst.x, burst.y, burst.size * burst.life * 0.5, burst.x, burst.y, burst.size * burst.life * 2);\n        gradient.addColorStop(0, getCachedColor('rgba(207, 185, 130, ', burst.life * 0.3));\n        gradient.addColorStop(1, 'rgba(207, 185, 130, 0)');\n        ctx.fillStyle = gradient;\n        ctx.fill();\n      }\n    });\n\n    // Draw cursor influence - enhanced glow effect\n    if (enableCursorGlow && smoothCursorPosition.current.x && smoothCursorPosition.current.y) {\n      // Outer glow\n      const glowRadius = 120;\n      const gradient = ctx.createRadialGradient(smoothCursorPosition.current.x, smoothCursorPosition.current.y, 0, smoothCursorPosition.current.x, smoothCursorPosition.current.y, glowRadius);\n      gradient.addColorStop(0, 'rgba(160, 142, 97, 0.05)');\n      gradient.addColorStop(0.5, 'rgba(160, 142, 97, 0.02)');\n      gradient.addColorStop(1, 'rgba(160, 142, 97, 0)');\n      ctx.beginPath();\n      ctx.arc(smoothCursorPosition.current.x, smoothCursorPosition.current.y, glowRadius, 0, Math.PI * 2);\n      ctx.fillStyle = gradient;\n      ctx.fill();\n\n      // Create occasional particles at cursor position\n      if (enableStarBurst && Math.random() < 0.01) {\n        createStarBurst(smoothCursorPosition.current.x, smoothCursorPosition.current.y, 1 + Math.random(), Math.floor(Math.random() * 3) + 1);\n      }\n    }\n  }, [dimensions, cursorPosition, enableParallax, respectReducedMotion, prefersReducedMotion, adaptiveSettings, getCachedColor, enableStarBurst, createStarBurst, enableCursorGlow]);\n\n  // FPS limiter for consistent animation rate\n  const fpsLimiter = useCallback((timestamp, callback) => {\n    // Skip animation if hidden, inactive, or reduced motion\n    if (!isVisible || respectReducedMotion && prefersReducedMotion) {\n      requestRef.current = requestAnimationFrame(time => fpsLimiter(time, callback));\n      return;\n    }\n    const targetFrameTime = 1000 / targetFPS;\n    const elapsed = timestamp - lastFrameTimeRef.current;\n    if (elapsed >= targetFrameTime || lastFrameTimeRef.current === 0) {\n      // Calculate correct delta time, capping to avoid jumps\n      const deltaTime = Math.min(elapsed, 33); // Cap at ~30fps equivalent\n\n      // Update timestamps\n      const actualFrameTime = timestamp - lastRenderTimeRef.current;\n      lastFrameTimeRef.current = timestamp;\n      lastRenderTimeRef.current = timestamp;\n\n      // Run animation callback with capped delta time\n      callback(timestamp, deltaTime);\n\n      // FPS measurement\n      frameCountRef.current++;\n      if (timestamp - fpsCounterRef.current >= 1000) {\n        // Reset counter\n        frameCountRef.current = 0;\n        fpsCounterRef.current = timestamp;\n      }\n    }\n\n    // Schedule next frame\n    requestRef.current = requestAnimationFrame(time => fpsLimiter(time, callback));\n  }, [isVisible, respectReducedMotion, prefersReducedMotion, targetFPS]);\n\n  // Main animation function\n  const animate = useCallback((timestamp, deltaTime) => {\n    timeRef.current = timestamp;\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    if (renderingMode === 'webgl' && webGLRef.current) {\n      // WebGL rendering path (simplified)\n      const gl = webGLRef.current;\n      gl.clear(gl.COLOR_BUFFER_BIT);\n\n      // In a real implementation, this would render the scene using WebGL\n      // Currently falls back to 2D Canvas as WebGL implementation is a placeholder\n      const ctx = canvas.getContext('2d');\n      drawBackground2D(ctx, timestamp, deltaTime);\n    } else {\n      // Canvas 2D rendering path\n      const ctx = canvas.getContext('2d');\n      drawBackground2D(ctx, timestamp, deltaTime);\n    }\n  }, [renderingMode, drawBackground2D]);\n\n  // Start animation loop\n  useEffect(() => {\n    if (!dimensions.width || !dimensions.height) return;\n\n    // Start animation with FPS limiter\n    lastFrameTimeRef.current = 0;\n    fpsCounterRef.current = performance.now();\n    frameCountRef.current = 0;\n    requestRef.current = requestAnimationFrame(timestamp => {\n      fpsLimiter(timestamp, animate);\n    });\n    return () => {\n      if (requestRef.current) {\n        cancelAnimationFrame(requestRef.current);\n      }\n    };\n  }, [dimensions, fpsLimiter, animate]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.backgroundWrapper,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.backgroundBlack\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 916,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      className: classes.backgroundCanvas\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 918,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 914,\n    columnNumber: 5\n  }, this);\n};\n_s(Background, \"6Ln1Tqyx+3kFL+6GZoIR/hFEraE=\", false, function () {\n  return [useStyles];\n});\n_c = Background;\nexport default Background;\nvar _c;\n$RefreshReg$(_c, \"Background\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useMemo","createUseStyles","jsxDEV","_jsxDEV","useStyles","backgroundWrapper","position","top","left","width","height","zIndex","pointerEvents","overflow","transform","backfaceVisibility","perspective","willChange","backgroundBlack","backgroundColor","backgroundCanvas","imageRendering","CONSTELLATIONS","name","vertices","x","y","edges","Background","cursorPosition","setCursorPosition","enableWebGL","adaptiveQuality","enableParallax","respectReducedMotion","particleCount","enableCursorGlow","targetFPS","enableStarBurst","_s","classes","canvasRef","particlesRef","constellationsRef","requestRef","timeRef","lastFrameTimeRef","frameCountRef","fpsCounterRef","lastRenderTimeRef","webGLRef","dimensions","setDimensions","pixelRatio","isVisible","setIsVisible","prefersReducedMotion","setPrefersReducedMotion","qualityFactor","setQualityFactor","renderingMode","setRenderingMode","deviceCapabilities","setDeviceCapabilities","isMobile","batteryLevel","isCharging","memoryLimit","smoothCursorPosition","particlePoolRef","starBurstPoolRef","activeStarBurstsRef","colorCacheRef","Map","getCachedColor","baseColor","opacity","roundedOpacity","Math","round","key","current","has","newColor","replace","set","get","detectCapabilities","test","navigator","userAgent","webGLSupported","canvas","document","createElement","window","WebGLRenderingContext","getContext","e","prev","memory","deviceMemory","cores","hardwareConcurrency","performanceScore","quality","getBattery","then","battery","updateBattery","level","charging","min","addEventListener","adaptiveSettings","actualParticleCount","max","floor","starSize","useGlow","useHighQualityEdges","constellationOpacity","twinkleFrequency","particleSpeed","initializeParticles","newParticles","i","particle","length","pop","random","isTwinkling","size","baseSize","speedX","speedY","baseOpacity","twinkleSpeed","twinklePhase","PI","twinkleProbability","canBurst","burstThreshold","lastBurstTime","burstCooldown","push","initializeConstellations","map","constellation","vertex","twinkleProgress","lastTwinkle","twinkleInterval","originalX","originalY","parallaxFactor","isHighlighted","highlightProgress","highlightSpeed","lastHighlight","highlightInterval","createStarBurst","burst","life","vx","vy","decay","angle","speed","cos","sin","initWebGL","gl","alpha","antialias","premultipliedAlpha","depth","powerPreference","enable","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","clearColor","error","console","setupCanvas","devicePixelRatio","displayWidth","innerWidth","displayHeight","innerHeight","style","ctx","scale","desynchronized","willReadFrequently","imageSmoothingEnabled","imageSmoothingQuality","handleResize","reducedMotionQuery","matchMedia","matches","handleReducedMotionChange","handleVisibilityChange","hidden","removeEventListener","cancelAnimationFrame","drawBackground2D","timestamp","deltaTime","fillStyle","fillRect","parallaxOffsetX","parallaxOffsetY","forEach","particleOpacity","particleSize","twinkleFactor","normalizedTwinkle","drawX","drawY","beginPath","arc","fill","gradient","createRadialGradient","addColorStop","now","edgeOpacity","vertexMultiplier","highlightPulse","edge","startVertex","endVertex","startX","startY","endX","endY","createLinearGradient","moveTo","lineTo","strokeStyle","lineWidth","stroke","vertexSize","vertexOpacity","pulseFactor","index","splice","glowRadius","fpsLimiter","callback","requestAnimationFrame","time","targetFrameTime","elapsed","actualFrameTime","animate","clear","COLOR_BUFFER_BIT","performance","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","_c","$RefreshReg$"],"sources":["/home/valeria/Documents/Crucible/frontend/src/components/core/Background.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';\nimport { createUseStyles } from 'react-jss';\n\n// Enhanced CSS-in-JS styles with hardware acceleration and performance optimizations\nconst useStyles = createUseStyles({\n  backgroundWrapper: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    zIndex: 1,\n    pointerEvents: 'none',\n    overflow: 'hidden',\n    // Hardware acceleration\n    transform: 'translateZ(0)',\n    backfaceVisibility: 'hidden',\n    perspective: 1000,\n    willChange: 'transform'\n  },\n  backgroundBlack: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    backgroundColor: '#000000',\n    zIndex: 1,\n  },\n  backgroundCanvas: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    zIndex: 1,\n    pointerEvents: 'none',\n    // Hardware acceleration\n    transform: 'translateZ(0)',\n    backfaceVisibility: 'hidden',\n    perspective: 1000,\n    willChange: 'transform',\n    // Ensure proper rendering\n    imageRendering: 'high-quality'\n  }\n});\n\n// Enhanced constellation definitions with more stars and connections\nconst CONSTELLATIONS = [\n  {\n    name: 'Ursa Major',\n    vertices: [\n      { x: 0.2, y: 0.3 }, { x: 0.25, y: 0.28 }, { x: 0.3, y: 0.25 },\n      { x: 0.35, y: 0.23 }, { x: 0.37, y: 0.18 }, { x: 0.33, y: 0.15 },\n      { x: 0.28, y: 0.15 }\n    ],\n    edges: [[0, 1], [1, 2], [2, 3], [3, 4], [4, 5], [5, 6]]\n  },\n  {\n    name: 'Cassiopeia',\n    vertices: [\n      { x: 0.7, y: 0.15 }, { x: 0.75, y: 0.2 }, { x: 0.8, y: 0.15 },\n      { x: 0.85, y: 0.2 }, { x: 0.9, y: 0.15 }\n    ],\n    edges: [[0, 1], [1, 2], [2, 3], [3, 4]]\n  },\n  {\n    name: 'Orion',\n    vertices: [\n      { x: 0.5, y: 0.5 }, { x: 0.48, y: 0.45 }, { x: 0.52, y: 0.45 },\n      { x: 0.51, y: 0.4 }, { x: 0.5, y: 0.35 }, { x: 0.53, y: 0.32 },\n      { x: 0.47, y: 0.32 }\n    ],\n    edges: [[0, 1], [0, 2], [1, 3], [2, 3], [3, 4], [4, 5], [4, 6]]\n  },\n  {\n    name: 'Cygnus',\n    vertices: [\n      { x: 0.15, y: 0.65 }, { x: 0.2, y: 0.6 }, { x: 0.25, y: 0.55 },\n      { x: 0.3, y: 0.5 }, { x: 0.35, y: 0.45 }, { x: 0.25, y: 0.5 },\n      { x: 0.15, y: 0.5 }\n    ],\n    edges: [[0, 1], [1, 2], [2, 3], [3, 4], [2, 5], [5, 6]]\n  }\n];\n\n/**\n * Enterprise-grade Background Component\n * \n * Creates a high-performance animated starry background with constellations,\n * interactive cursor effects, and optimized rendering for all devices.\n * \n * Features:\n * - Hardware accelerated rendering with Canvas 2D or WebGL\n * - Device-adaptive quality settings for better performance\n * - Optimized memory usage with object pooling\n * - Battery-aware rendering for mobile devices\n * - Smooth animations with efficient frame management\n * - Enhanced visual effects with adaptive detail levels\n * \n * @param {Object} props - Component props\n * @param {Object} props.cursorPosition - Current cursor coordinates\n * @param {Function} props.setCursorPosition - Function to update cursor position\n * @param {boolean} [props.enableWebGL=false] - Enable WebGL rendering for better performance\n * @param {boolean} [props.adaptiveQuality=true] - Enable adaptive quality based on device\n * @param {boolean} [props.enableParallax=true] - Enable parallax effect on scroll/cursor\n * @param {boolean} [props.respectReducedMotion=true] - Respect reduced motion preferences\n * @param {number} [props.particleCount=80] - Number of background particles\n * @param {boolean} [props.enableCursorGlow=true] - Enable cursor glow effect\n * @param {number} [props.targetFPS=30] - Target frame rate\n * @param {boolean} [props.enableStarBurst=true] - Enable occasional star burst effects\n */\nconst Background = ({\n  cursorPosition, \n  setCursorPosition,\n  enableWebGL = false,\n  adaptiveQuality = true,\n  enableParallax = true,\n  respectReducedMotion = true,\n  particleCount = 80,\n  enableCursorGlow = true,\n  targetFPS = 30,\n  enableStarBurst = true\n}) => {\n  // Styles and refs\n  const classes = useStyles();\n  const canvasRef = useRef(null);\n  const particlesRef = useRef([]);\n  const constellationsRef = useRef([]);\n  const requestRef = useRef(null);\n  const timeRef = useRef(0);\n  const lastFrameTimeRef = useRef(0);\n  const frameCountRef = useRef(0);\n  const fpsCounterRef = useRef(0);\n  const lastRenderTimeRef = useRef(0);\n  const webGLRef = useRef(null);\n  \n  // Component state\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0, pixelRatio: 1 });\n  const [isVisible, setIsVisible] = useState(true);\n  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);\n  const [qualityFactor, setQualityFactor] = useState(1);\n  const [renderingMode, setRenderingMode] = useState('2d');\n  const [deviceCapabilities, setDeviceCapabilities] = useState({\n    isMobile: false,\n    batteryLevel: 1,\n    isCharging: true,\n    memoryLimit: false\n  });\n  \n  // Optimized cursor position with interpolation for smoother movement\n  const smoothCursorPosition = useRef({ x: 0, y: 0 });\n  \n  // Particle and star burst object pools\n  const particlePoolRef = useRef([]);\n  const starBurstPoolRef = useRef([]);\n  const activeStarBurstsRef = useRef([]);\n  \n  // Color caching to avoid string operations during rendering\n  const colorCacheRef = useRef(new Map());\n  \n  // Get cached color with opacity\n  const getCachedColor = useCallback((baseColor, opacity) => {\n    // Round opacity to reduce cache size (0.01 precision is enough for visual effects)\n    const roundedOpacity = Math.round(opacity * 100) / 100;\n    const key = `${baseColor}-${roundedOpacity}`;\n    \n    if (!colorCacheRef.current.has(key)) {\n      const newColor = baseColor.replace(/[\\d.]+\\)$/, roundedOpacity + ')');\n      colorCacheRef.current.set(key, newColor);\n    }\n    \n    return colorCacheRef.current.get(key);\n  }, []);\n  \n  // Detect device capabilities and set appropriate quality levels\n  const detectCapabilities = useCallback(() => {\n    // Check for mobile devices\n    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n    \n    // Check for WebGL support\n    let webGLSupported = false;\n    if (enableWebGL) {\n      try {\n        const canvas = document.createElement('canvas');\n        webGLSupported = !!(window.WebGLRenderingContext && \n          (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));\n      } catch (e) {\n        webGLSupported = false;\n      }\n    }\n    \n    // Set rendering mode based on capabilities\n    setRenderingMode(webGLSupported && enableWebGL ? 'webgl' : '2d');\n    \n    // Set device capability state\n    setDeviceCapabilities(prev => ({\n      ...prev,\n      isMobile\n    }));\n    \n    // Determine quality factor based on device capabilities\n    if (adaptiveQuality) {\n      const memory = navigator.deviceMemory || 4; // Default to 4GB if not available\n      const cores = navigator.hardwareConcurrency || 4; // Default to 4 cores\n      \n      // Calculate performance score\n      const performanceScore = (memory * cores) / (isMobile ? 2 : 1);\n      \n      // Scale quality based on performance score\n      let quality = 1;\n      \n      if (performanceScore > 16) {\n        quality = 1; // High-end devices\n      } else if (performanceScore > 8) {\n        quality = 0.85; // Mid-range devices\n      } else if (performanceScore > 4) {\n        quality = 0.7; // Low-end devices\n      } else {\n        quality = 0.5; // Very low-end devices\n      }\n      \n      setQualityFactor(quality);\n    }\n    \n    // Check battery status if available\n    if (navigator.getBattery) {\n      navigator.getBattery().then(battery => {\n        const updateBattery = () => {\n          setDeviceCapabilities(prev => ({\n            ...prev,\n            batteryLevel: battery.level,\n            isCharging: battery.charging\n          }));\n          \n          // Reduce quality if on low battery and not charging\n          if (!battery.charging && battery.level < 0.3 && adaptiveQuality) {\n            setQualityFactor(prev => Math.min(prev, 0.6));\n          }\n        };\n        \n        // Add battery event listeners\n        battery.addEventListener('levelchange', updateBattery);\n        battery.addEventListener('chargingchange', updateBattery);\n        \n        // Initial update\n        updateBattery();\n      });\n    }\n  }, [enableWebGL, adaptiveQuality]);\n  \n  // Calculate adaptive settings based on device capabilities and quality factor\n  const adaptiveSettings = useMemo(() => {\n    const actualParticleCount = Math.max(40, Math.floor(particleCount * qualityFactor));\n    \n    return {\n      particleCount: actualParticleCount,\n      starSize: qualityFactor > 0.8 ? 1 : 0.8,\n      useGlow: qualityFactor > 0.6,\n      useHighQualityEdges: qualityFactor > 0.7,\n      constellationOpacity: 0.1 * qualityFactor,\n      twinkleFrequency: qualityFactor > 0.7 ? 0.0004 : 0.0002,\n      particleSpeed: 0.15 * qualityFactor\n    };\n  }, [qualityFactor, particleCount]);\n  \n  // Initialize particles with appropriate pooling\n  const initializeParticles = useCallback(() => {\n    if (!dimensions.width || !dimensions.height) return;\n    \n    const width = dimensions.width;\n    const height = dimensions.height;\n    \n    // Create new particles\n    const newParticles = [];\n    \n    // Try to get from pool first, then create new ones if needed\n    for (let i = 0; i < adaptiveSettings.particleCount; i++) {\n      let particle;\n      \n      if (particlePoolRef.current.length > 0) {\n        // Reuse from pool\n        particle = particlePoolRef.current.pop();\n        \n        // Reset particle properties\n        particle.x = Math.random() * width;\n        particle.y = Math.random() * height;\n        particle.isTwinkling = false;\n      } else {\n        // Create new particle\n        particle = {\n          x: Math.random() * width,\n          y: Math.random() * height,\n          size: Math.random() * 1.5 * adaptiveSettings.starSize + 0.5,\n          baseSize: Math.random() * 1.5 * adaptiveSettings.starSize + 0.5,\n          speedX: (Math.random() - 0.5) * adaptiveSettings.particleSpeed,\n          speedY: (Math.random() - 0.5) * adaptiveSettings.particleSpeed,\n          opacity: Math.random() * 0.3 + 0.05,\n          baseOpacity: Math.random() * 0.3 + 0.05,\n          twinkleSpeed: Math.random() * 0.02 + 0.005,\n          twinklePhase: Math.random() * Math.PI * 2,\n          twinkleProbability: Math.random() * adaptiveSettings.twinkleFrequency + 0.0001,\n          isTwinkling: false,\n          // For star bursts\n          canBurst: Math.random() < 0.1, // 10% of stars can burst\n          burstThreshold: Math.random() * 0.002 + 0.0001,\n          lastBurstTime: 0,\n          burstCooldown: Math.random() * 15000 + 5000\n        };\n      }\n      \n      newParticles.push(particle);\n    }\n    \n    particlesRef.current = newParticles;\n  }, [dimensions, adaptiveSettings]);\n  \n  // Initialize constellations\n  const initializeConstellations = useCallback(() => {\n    if (!dimensions.width || !dimensions.height) return;\n    \n    // Initialize constellations with actual screen positions\n    constellationsRef.current = CONSTELLATIONS.map(constellation => {\n      const vertices = constellation.vertices.map(vertex => ({\n        x: vertex.x * dimensions.width,\n        y: vertex.y * dimensions.height,\n        size: 1.8 * adaptiveSettings.starSize,\n        baseSize: 1.8 * adaptiveSettings.starSize,\n        opacity: 0.25 * qualityFactor,\n        baseOpacity: 0.25 * qualityFactor,\n        isTwinkling: false,\n        twinkleProgress: 0,\n        twinkleSpeed: Math.random() * 0.03 + 0.01,\n        lastTwinkle: 0,\n        twinkleInterval: Math.random() * 5000 + 2000,\n        // For parallax effect\n        originalX: vertex.x * dimensions.width,\n        originalY: vertex.y * dimensions.height,\n        parallaxFactor: Math.random() * 0.2 + 0.1\n      }));\n      \n      return {\n        name: constellation.name,\n        vertices,\n        edges: constellation.edges,\n        // For occasional constellation highlighting\n        isHighlighted: false,\n        highlightProgress: 0,\n        highlightSpeed: 0.01,\n        lastHighlight: 0,\n        highlightInterval: Math.random() * 30000 + 20000\n      };\n    });\n  }, [dimensions, adaptiveSettings.starSize, qualityFactor]);\n  \n  // Create star burst effect at a specific position\n  const createStarBurst = useCallback((x, y, size = 2, particleCount = 8) => {\n    if (!enableStarBurst) return;\n    \n    for (let i = 0; i < particleCount; i++) {\n      // Try to get from pool first\n      let burst;\n      \n      if (starBurstPoolRef.current.length > 0) {\n        burst = starBurstPoolRef.current.pop();\n        \n        // Reset burst properties\n        burst.life = 1.0;\n        burst.x = x;\n        burst.y = y;\n      } else {\n        // Create new burst particle\n        burst = {\n          x,\n          y,\n          vx: 0,\n          vy: 0,\n          size: 0,\n          life: 1.0,\n          decay: 0\n        };\n      }\n      \n      // Randomize burst parameters\n      const angle = Math.random() * Math.PI * 2;\n      const speed = Math.random() * 2 + 0.5;\n      \n      burst.vx = Math.cos(angle) * speed;\n      burst.vy = Math.sin(angle) * speed;\n      burst.size = size * (0.5 + Math.random() * 0.5);\n      burst.decay = 0.01 + Math.random() * 0.02;\n      \n      activeStarBurstsRef.current.push(burst);\n    }\n  }, [enableStarBurst]);\n  \n  // Initialize WebGL context if enabled\n  const initWebGL = useCallback(() => {\n    if (!canvasRef.current || renderingMode !== 'webgl') return false;\n    \n    try {\n      const gl = canvasRef.current.getContext('webgl', {\n        alpha: true,\n        antialias: true,\n        premultipliedAlpha: false,\n        depth: false,\n        powerPreference: 'default'\n      });\n      \n      if (!gl) return false;\n      \n      webGLRef.current = gl;\n      \n      // Basic WebGL setup (simplified)\n      gl.enable(gl.BLEND);\n      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n      gl.clearColor(0.0, 0.0, 0.0, 1.0);\n      \n      return true;\n    } catch (error) {\n      console.error('WebGL initialization error:', error);\n      setRenderingMode('2d');\n      return false;\n    }\n  }, [renderingMode]);\n  \n  // Canvas setup with proper scaling for high-DPI displays\n  const setupCanvas = useCallback(() => {\n    if (!canvasRef.current) return false;\n    \n    const canvas = canvasRef.current;\n    const pixelRatio = window.devicePixelRatio || 1;\n    \n    // Get display dimensions\n    const displayWidth = window.innerWidth;\n    const displayHeight = window.innerHeight;\n    \n    // Set canvas rendering size (accounting for pixel ratio)\n    canvas.width = displayWidth * pixelRatio;\n    canvas.height = displayHeight * pixelRatio;\n    \n    // Set display size via CSS\n    canvas.style.width = `${displayWidth}px`;\n    canvas.style.height = `${displayHeight}px`;\n    \n    // Store dimensions\n    setDimensions({\n      width: displayWidth,\n      height: displayHeight,\n      pixelRatio\n    });\n    \n    // Initialize appropriate rendering context\n    if (renderingMode === 'webgl') {\n      if (!initWebGL()) {\n        // Fallback to 2D if WebGL fails\n        const ctx = canvas.getContext('2d');\n        ctx.scale(pixelRatio, pixelRatio);\n      }\n    } else {\n      // 2D Canvas context\n      const ctx = canvas.getContext('2d', {\n        alpha: true,\n        desynchronized: true,\n        willReadFrequently: false\n      });\n      \n      if (!ctx) return false;\n      \n      // Scale context for high-DPI displays\n      ctx.scale(pixelRatio, pixelRatio);\n      \n      // Enable high-quality rendering if device can handle it\n      if (qualityFactor > 0.7) {\n        ctx.imageSmoothingEnabled = true;\n        ctx.imageSmoothingQuality = 'high';\n      }\n    }\n    \n    return true;\n  }, [qualityFactor, renderingMode, initWebGL]);\n  \n  // Handle window resize\n  const handleResize = useCallback(() => {\n    if (setupCanvas()) {\n      // Reinitialize particles and constellations\n      initializeParticles();\n      initializeConstellations();\n    }\n  }, [setupCanvas, initializeParticles, initializeConstellations]);\n  \n  // Detect device capabilities and preferences\n  useEffect(() => {\n    // Check for reduced motion preference\n    const reducedMotionQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\n    setPrefersReducedMotion(reducedMotionQuery.matches);\n    \n    const handleReducedMotionChange = (e) => {\n      setPrefersReducedMotion(e.matches);\n    };\n    \n    reducedMotionQuery.addEventListener('change', handleReducedMotionChange);\n    \n    // Detect device capabilities\n    detectCapabilities();\n    \n    // Handle visibility changes\n    const handleVisibilityChange = () => {\n      setIsVisible(!document.hidden);\n    };\n    \n    document.addEventListener('visibilitychange', handleVisibilityChange);\n    \n    return () => {\n      reducedMotionQuery.removeEventListener('change', handleReducedMotionChange);\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n    };\n  }, [detectCapabilities]);\n  \n  // Set up responsive canvas and initialize particles\n  useEffect(() => {\n    // Initial setup\n    setupCanvas();\n    \n    // Add resize listener\n    window.addEventListener('resize', handleResize);\n    \n    return () => {\n      window.removeEventListener('resize', handleResize);\n      if (requestRef.current) {\n        cancelAnimationFrame(requestRef.current);\n      }\n    };\n  }, [setupCanvas, handleResize]);\n  \n  // Initialize particles and constellations when dimensions are available\n  useEffect(() => {\n    if (dimensions.width && dimensions.height) {\n      initializeParticles();\n      initializeConstellations();\n    }\n  }, [dimensions, initializeParticles, initializeConstellations]);\n  \n  // Draw 2D canvas background\n  const drawBackground2D = useCallback((ctx, timestamp, deltaTime) => {\n    // Start with black background\n    ctx.fillStyle = '#000000';\n    ctx.fillRect(0, 0, dimensions.width, dimensions.height);\n    \n    // Calculate interpolated cursor position for smoother effects\n    if (cursorPosition.x && cursorPosition.y) {\n      smoothCursorPosition.current.x += (cursorPosition.x - smoothCursorPosition.current.x) * 0.1;\n      smoothCursorPosition.current.y += (cursorPosition.y - smoothCursorPosition.current.y) * 0.1;\n    }\n    \n    // Calculate parallax offset based on cursor position\n    const parallaxOffsetX = enableParallax ? (smoothCursorPosition.current.x - dimensions.width / 2) / 20 : 0;\n    const parallaxOffsetY = enableParallax ? (smoothCursorPosition.current.y - dimensions.height / 2) / 20 : 0;\n    \n    // Draw regular particles\n    particlesRef.current.forEach(particle => {\n      // Skip updates if reduced motion is preferred\n      if (!(respectReducedMotion && prefersReducedMotion)) {\n        // Update position\n        particle.x += particle.speedX;\n        particle.y += particle.speedY;\n        \n        // Wrap around screen with buffer\n        if (particle.x < -20) particle.x = dimensions.width + 20;\n        if (particle.x > dimensions.width + 20) particle.x = -20;\n        if (particle.y < -20) particle.y = dimensions.height + 20;\n        if (particle.y > dimensions.height + 20) particle.y = -20;\n      }\n      \n      // Handle twinkling effect\n      if (Math.random() < particle.twinkleProbability) {\n        particle.isTwinkling = true;\n      }\n      \n      let particleOpacity = particle.opacity;\n      let particleSize = particle.size;\n      \n      if (particle.isTwinkling) {\n        // Use sine wave for smooth twinkling effect\n        const twinkleFactor = Math.sin(timestamp * 0.001 * particle.twinkleSpeed + particle.twinklePhase);\n        const normalizedTwinkle = (twinkleFactor + 1) / 2; // Convert from [-1,1] to [0,1]\n        \n        particleSize = particle.baseSize + (particle.baseSize * 0.7 * normalizedTwinkle);\n        particleOpacity = particle.baseOpacity + (0.4 * normalizedTwinkle);\n        \n        // Complete one twinkle cycle\n        if (timestamp * 0.001 * particle.twinkleSpeed + particle.twinklePhase > particle.twinklePhase + Math.PI * 2) {\n          particle.isTwinkling = false;\n          particle.twinklePhase = Math.random() * Math.PI * 2; // Reset phase for next time\n        }\n      }\n      \n      // Check for star burst\n      if (enableStarBurst && particle.canBurst && Math.random() < particle.burstThreshold && \n          timestamp - particle.lastBurstTime > particle.burstCooldown) {\n        createStarBurst(particle.x, particle.y, particle.size * 1.5, 8);\n        particle.lastBurstTime = timestamp;\n      }\n      \n      // Compute final position with parallax\n      const drawX = particle.x + parallaxOffsetX * 0.5;\n      const drawY = particle.y + parallaxOffsetY * 0.5;\n      \n      // Draw particle\n      ctx.beginPath();\n      ctx.arc(drawX, drawY, particleSize, 0, Math.PI * 2);\n      ctx.fillStyle = getCachedColor('rgba(191, 173, 127) ', particleOpacity);\n      ctx.fill();\n      \n      // Add glow effect for larger or twinkling particles if quality permits\n      if (adaptiveSettings.useGlow && (particleSize > 1.3 || particle.isTwinkling)) {\n        ctx.beginPath();\n        ctx.arc(drawX, drawY, particleSize * 2, 0, Math.PI * 2);\n        const gradient = ctx.createRadialGradient(\n          drawX, drawY, particleSize * 0.5,\n          drawX, drawY, particleSize * 2\n        );\n        gradient.addColorStop(0, getCachedColor('rgba(191, 173, 127)', particleOpacity * 0.4));\n        gradient.addColorStop(1, 'rgba(191, 173, 127, 0)');\n        ctx.fillStyle = gradient;\n        ctx.fill();\n      }\n    });\n    \n    // Draw constellations\n    constellationsRef.current.forEach(constellation => {\n      const now = timestamp;\n      let edgeOpacity = adaptiveSettings.constellationOpacity;\n      let vertexMultiplier = 1;\n      \n      // Check if it's time to highlight this constellation\n      if (now - constellation.lastHighlight > constellation.highlightInterval) {\n        constellation.isHighlighted = true;\n        constellation.highlightProgress = 0;\n        constellation.lastHighlight = now;\n      }\n      \n      // Handle highlighting animation\n      if (constellation.isHighlighted) {\n        constellation.highlightProgress += constellation.highlightSpeed * (deltaTime / 16);\n        \n        // Create a pulse effect for highlighting\n        const highlightPulse = Math.sin(constellation.highlightProgress * Math.PI);\n        edgeOpacity += highlightPulse * 0.15;\n        vertexMultiplier += highlightPulse * 0.5;\n        \n        // End highlighting after one cycle\n        if (constellation.highlightProgress >= 1) {\n          constellation.isHighlighted = false;\n        }\n      }\n      \n      // Draw edges (lines) first so they appear behind vertices\n      if (adaptiveSettings.useHighQualityEdges) {\n        // Enhanced edges with gradient for higher quality settings\n        constellation.edges.forEach(edge => {\n          const startVertex = constellation.vertices[edge[0]];\n          const endVertex = constellation.vertices[edge[1]];\n          \n          // Apply parallax to edge vertices\n          const startX = startVertex.x + parallaxOffsetX * startVertex.parallaxFactor;\n          const startY = startVertex.y + parallaxOffsetY * startVertex.parallaxFactor;\n          const endX = endVertex.x + parallaxOffsetX * endVertex.parallaxFactor;\n          const endY = endVertex.y + parallaxOffsetY * endVertex.parallaxFactor;\n          \n          // Create gradient along the line\n          const gradient = ctx.createLinearGradient(startX, startY, endX, endY);\n          gradient.addColorStop(0, getCachedColor('rgba(191, 173, 127, ', edgeOpacity));\n          gradient.addColorStop(0.5, getCachedColor('rgba(191, 173, 127, ', edgeOpacity * 1.3));\n          gradient.addColorStop(1, getCachedColor('rgba(191, 173, 127, ', edgeOpacity));\n          \n          ctx.beginPath();\n          ctx.moveTo(startX, startY);\n          ctx.lineTo(endX, endY);\n          ctx.strokeStyle = gradient;\n          ctx.lineWidth = 0.5;\n          ctx.stroke();\n        });\n      } else {\n        // Simple edges for lower quality settings\n        ctx.beginPath();\n        ctx.strokeStyle = getCachedColor('rgba(191, 173, 127, ', edgeOpacity);\n        ctx.lineWidth = 0.5;\n        \n        constellation.edges.forEach(edge => {\n          const startVertex = constellation.vertices[edge[0]];\n          const endVertex = constellation.vertices[edge[1]];\n          \n          // Apply parallax\n          const startX = startVertex.x + parallaxOffsetX * startVertex.parallaxFactor;\n          const startY = startVertex.y + parallaxOffsetY * startVertex.parallaxFactor;\n          const endX = endVertex.x + parallaxOffsetX * endVertex.parallaxFactor;\n          const endY = endVertex.y + parallaxOffsetY * endVertex.parallaxFactor;\n          \n          ctx.moveTo(startX, startY);\n          ctx.lineTo(endX, endY);\n        });\n        ctx.stroke();\n      }\n      \n      // Draw and update vertices\n      constellation.vertices.forEach(vertex => {\n        // Occasional twinkling for constellation stars\n        if (timestamp - vertex.lastTwinkle > vertex.twinkleInterval) {\n          vertex.isTwinkling = true;\n          vertex.twinkleProgress = 0;\n          vertex.lastTwinkle = timestamp;\n        }\n        \n        let vertexSize = vertex.size * vertexMultiplier;\n        let vertexOpacity = vertex.opacity * vertexMultiplier;\n        \n        if (vertex.isTwinkling) {\n          vertex.twinkleProgress += vertex.twinkleSpeed * (deltaTime / 16);\n          \n          // Create a pulse effect\n          const pulseFactor = Math.sin(vertex.twinkleProgress * Math.PI);\n          vertexSize += vertex.baseSize * pulseFactor * 0.5;\n          vertexOpacity += 0.3 * pulseFactor;\n          \n          // End twinkling after one cycle\n          if (vertex.twinkleProgress >= 1) {\n            vertex.isTwinkling = false;\n          }\n        }\n        \n        // Apply parallax to vertex position\n        const drawX = vertex.x + parallaxOffsetX * vertex.parallaxFactor;\n        const drawY = vertex.y + parallaxOffsetY * vertex.parallaxFactor;\n        \n        // Draw constellation vertex\n        ctx.beginPath();\n        ctx.arc(drawX, drawY, vertexSize, 0, Math.PI * 2);\n        ctx.fillStyle = getCachedColor('rgba(207, 185, 130, ', vertexOpacity);\n        ctx.fill();\n        \n        // Add glow for constellation vertices if quality permits\n        if (adaptiveSettings.useGlow) {\n          ctx.beginPath();\n          ctx.arc(drawX, drawY, vertexSize * 3, 0, Math.PI * 2);\n          const gradient = ctx.createRadialGradient(\n            drawX, drawY, vertexSize * 0.5,\n            drawX, drawY, vertexSize * 3\n          );\n          gradient.addColorStop(0, getCachedColor('rgba(207, 185, 130, ', vertexOpacity * 0.4));\n          gradient.addColorStop(1, 'rgba(207, 185, 130, 0)');\n          ctx.fillStyle = gradient;\n          ctx.fill();\n        }\n      });\n    });\n    \n    // Draw active star bursts\n    activeStarBurstsRef.current.forEach((burst, index) => {\n      // Update burst position and life\n      burst.x += burst.vx;\n      burst.y += burst.vy;\n      burst.life -= burst.decay * (deltaTime / 16);\n      \n      // Remove if life is depleted\n      if (burst.life <= 0) {\n        // Return to pool\n        starBurstPoolRef.current.push(burst);\n        activeStarBurstsRef.current.splice(index, 1);\n        return;\n      }\n      \n      // Draw burst particle\n      ctx.beginPath();\n      ctx.arc(burst.x, burst.y, burst.size * burst.life, 0, Math.PI * 2);\n      ctx.fillStyle = getCachedColor('rgba(207, 185, 130, ', burst.life * 0.7);\n      ctx.fill();\n      \n      // Add glow for bursts\n      if (adaptiveSettings.useGlow) {\n        ctx.beginPath();\n        ctx.arc(burst.x, burst.y, burst.size * burst.life * 2, 0, Math.PI * 2);\n        const gradient = ctx.createRadialGradient(\n          burst.x, burst.y, burst.size * burst.life * 0.5,\n          burst.x, burst.y, burst.size * burst.life * 2\n        );\n        gradient.addColorStop(0, getCachedColor('rgba(207, 185, 130, ', burst.life * 0.3));\n        gradient.addColorStop(1, 'rgba(207, 185, 130, 0)');\n        ctx.fillStyle = gradient;\n        ctx.fill();\n      }\n    });\n    \n    // Draw cursor influence - enhanced glow effect\n    if (enableCursorGlow && smoothCursorPosition.current.x && smoothCursorPosition.current.y) {\n      // Outer glow\n      const glowRadius = 120;\n      const gradient = ctx.createRadialGradient(\n        smoothCursorPosition.current.x, smoothCursorPosition.current.y, 0,\n        smoothCursorPosition.current.x, smoothCursorPosition.current.y, glowRadius\n      );\n      gradient.addColorStop(0, 'rgba(160, 142, 97, 0.05)');\n      gradient.addColorStop(0.5, 'rgba(160, 142, 97, 0.02)');\n      gradient.addColorStop(1, 'rgba(160, 142, 97, 0)');\n      \n      ctx.beginPath();\n      ctx.arc(smoothCursorPosition.current.x, smoothCursorPosition.current.y, glowRadius, 0, Math.PI * 2);\n      ctx.fillStyle = gradient;\n      ctx.fill();\n      \n      // Create occasional particles at cursor position\n      if (enableStarBurst && Math.random() < 0.01) {\n        createStarBurst(\n          smoothCursorPosition.current.x, \n          smoothCursorPosition.current.y, \n          1 + Math.random(),\n          Math.floor(Math.random() * 3) + 1\n        );\n      }\n    }\n  }, [\n    dimensions, \n    cursorPosition,\n    enableParallax,\n    respectReducedMotion,\n    prefersReducedMotion,\n    adaptiveSettings,\n    getCachedColor,\n    enableStarBurst,\n    createStarBurst,\n    enableCursorGlow\n  ]);\n  \n  // FPS limiter for consistent animation rate\n  const fpsLimiter = useCallback((timestamp, callback) => {\n    // Skip animation if hidden, inactive, or reduced motion\n    if (!isVisible || (respectReducedMotion && prefersReducedMotion)) {\n      requestRef.current = requestAnimationFrame(time => fpsLimiter(time, callback));\n      return;\n    }\n    \n    const targetFrameTime = 1000 / targetFPS;\n    const elapsed = timestamp - lastFrameTimeRef.current;\n    \n    if (elapsed >= targetFrameTime || lastFrameTimeRef.current === 0) {\n      // Calculate correct delta time, capping to avoid jumps\n      const deltaTime = Math.min(elapsed, 33); // Cap at ~30fps equivalent\n      \n      // Update timestamps\n      const actualFrameTime = timestamp - lastRenderTimeRef.current;\n      lastFrameTimeRef.current = timestamp;\n      lastRenderTimeRef.current = timestamp;\n      \n      // Run animation callback with capped delta time\n      callback(timestamp, deltaTime);\n      \n      // FPS measurement\n      frameCountRef.current++;\n      if (timestamp - fpsCounterRef.current >= 1000) {\n        // Reset counter\n        frameCountRef.current = 0;\n        fpsCounterRef.current = timestamp;\n      }\n    }\n    \n    // Schedule next frame\n    requestRef.current = requestAnimationFrame(time => fpsLimiter(time, callback));\n  }, [isVisible, respectReducedMotion, prefersReducedMotion, targetFPS]);\n  \n  // Main animation function\n  const animate = useCallback((timestamp, deltaTime) => {\n    timeRef.current = timestamp;\n    \n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    \n    if (renderingMode === 'webgl' && webGLRef.current) {\n      // WebGL rendering path (simplified)\n      const gl = webGLRef.current;\n      gl.clear(gl.COLOR_BUFFER_BIT);\n      \n      // In a real implementation, this would render the scene using WebGL\n      // Currently falls back to 2D Canvas as WebGL implementation is a placeholder\n      const ctx = canvas.getContext('2d');\n      drawBackground2D(ctx, timestamp, deltaTime);\n    } else {\n      // Canvas 2D rendering path\n      const ctx = canvas.getContext('2d');\n      drawBackground2D(ctx, timestamp, deltaTime);\n    }\n  }, [renderingMode, drawBackground2D]);\n  \n  // Start animation loop\n  useEffect(() => {\n    if (!dimensions.width || !dimensions.height) return;\n    \n    // Start animation with FPS limiter\n    lastFrameTimeRef.current = 0;\n    fpsCounterRef.current = performance.now();\n    frameCountRef.current = 0;\n    \n    requestRef.current = requestAnimationFrame(timestamp => {\n      fpsLimiter(timestamp, animate);\n    });\n    \n    return () => {\n      if (requestRef.current) {\n        cancelAnimationFrame(requestRef.current);\n      }\n    };\n  }, [dimensions, fpsLimiter, animate]);\n  \n  return (\n    <div className={classes.backgroundWrapper}>\n      {/* Black background layer */}\n      <div className={classes.backgroundBlack}></div>\n      {/* Canvas for stars and constellations */}\n      <canvas ref={canvasRef} className={classes.backgroundCanvas} />\n    </div>\n  );\n};\n\nexport default Background;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}